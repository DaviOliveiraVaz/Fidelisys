<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="geral.css">
  <script src="https://unpkg.com/feather-icons"></script>
  <title>Perfil</title>
</head>
<body>
  <header>
    <div class="top-header">
        <div class="topbar-fixed" role="navigation">
          <div class="topbar-container">
            <div class="topbar-header">
              <button type="button" class="topbar-toggle" data-toggle="collapse" data-target=".topbar-collapse">
                <span class="topbar-bar"></span>
              </button>
              <div class="small-logo-container">
                <a class="small-logo" href="/home">Fidelisys</a>
              </div>
            </div>
            <div class="topbar-collapse collapse">
              <ul class="topbar-nav">
                <li><a href="/sair" onclick="return confirm('Tem certeza que deseja sair do sistema?')">Sair</a></li>
              </ul>
            </div>
          </div>
        </div>
<div class="sidebar" id="sidebar">
      <nav class="navbar">
        <ul class="navbar__menu">
          <li class="navbar__item">
            <a href="/home" class="navbar__link"><i data-feather="home"></i><span>Home</span></a>
          </li>
          <li class="navbar__item">
            <a href="/perfil" class="navbar__link"><i data-feather="user"></i><span>Perfil</span></a>        
          </li>
          <li class="navbar__item">
            <a href="/cadastro-cliente" class="navbar__link"><i data-feather="user-plus"></i><span>Cadastrar Cliente</span></a>        
          </li>
          <li class="navbar__item">
            <a href="/listar-clientes" class="navbar__link"><i data-feather="users"></i><span>Clientes</span></a>        
          </li>
          <li class="navbar__item">
            <a href="#" class="navbar__link"><i data-feather="settings"></i><span>Configurações</span></a>        
          </li>
        </ul>
      </nav>
    </div>
</header>

<div class="content">
  <h1 id="profile-subtitle">Olá, <%= usuario.nome %></h1>

  <div class="profile-image">
    <% if (!usuario.foto) { %>
      <img src="/profile-icon.png" id="profile-image"/>
    <% } else { %>
      <img src="<%= usuario.foto %>" id="profile-image"/>
    <% } %>
  </div>

  <div class="profile-data">
<section class="formulario">
  <div class="box">
    <div class="form-box">
      <form method="post" id="form" action="/editar-usuario/<%= usuario.id %>">
        <div class="input-grid">
          <div class="input-group">
            <input type="text" name="nome" class="input-form" id="nome" value="<%= usuario.nome %>" disabled required>
            <label for="nome">Nome</label>
          </div>
          <div class="input-group">
            <input type="text" name="email" class="input-form" id="email" value="<%= usuario.email %>" disabled required>
            <label for="email">E-mail</label>
          </div>
          <div class="input-group">
            <input type="text" name="telefone" class="input-form" id="telefone" value="<%= usuario.telefone %>" disabled required>
            <label for="telefone">Telefone</label>
          </div>
          <div class="input-group">
            <input type="password" name="senha" class="input-form" id="senha" value="<%= usuario.senha %>" disabled required>
            <label for="senha">Senha</label>
          </div>
        </div>

        <div class="button-group">
          <button type="submit" id="btn-salvar" class="btn-editar" style="display:none;">Salvar</button>
          <button type="button" id="btn-cancelar" class="btn-excluir" style="display:none;">Cancelar</button>
        </div>
      </form>
    </div>
    <div class="button-group">
      <button id="btn-editar-externo" class="btn-editar">Editar</button>
      <a href="/deletar-usuario/<%= usuario.id %>" id="btn-excluir-externo" class="btn-excluir" onclick="return confirm('Tem certeza que deseja excluir o usuário?')">Excluir</a>
  </div>
  </div>
</section>
<script>
  feather.replace();

  const btnEditarExterno = document.getElementById("btn-editar-externo");
  const btnSalvar = document.getElementById("btn-salvar");
  const btnCancelar = document.getElementById("btn-cancelar");
  const btnExcluir = document.getElementById("btn-excluir-externo");
  const inputs = document.getElementsByClassName("input-form");

  const originalValues = {
    nome: "<%= usuario.nome %>",
    email: "<%= usuario.email %>",
    telefone: "<%= usuario.telefone %>",
    senha: "<%= usuario.senha %>"
  };

  btnEditarExterno.addEventListener("click", () => {
    for (let input of inputs) input.disabled = false;

    btnSalvar.style.display = "inline-block";
    btnCancelar.style.display = "inline-block";

    btnEditarExterno.style.display = "none";

    btnExcluir.style.display = "none";
  });

  btnCancelar.addEventListener("click", () => {
    for (let input of inputs) {
      input.value = originalValues[input.name];
      input.disabled = true;
    }

    btnSalvar.style.display = "none";
    btnCancelar.style.display = "none";

    btnEditarExterno.style.display = "inline-block";

    btnExcluir.style.display = "inline-block";
  });
</script>

</body>
</html>
